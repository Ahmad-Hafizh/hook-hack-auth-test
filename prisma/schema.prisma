generator client {
  provider = "prisma-client"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
}

model User {
  id               String            @id @default(cuid())
  userId           String            @unique
  email            String?           @unique
  phoneNumber      String?
  tiktokUsername   String?
  credit           Int               @default(0)
  createdAt        DateTime          @default(now()) @db.Timestamptz(6)
  updatedAt        DateTime          @updatedAt @db.Timestamptz(6)
  firstName        String?
  lastName         String?
  planningSessions PlanningSession[]
  transaction      Transaction[]
  project          project[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model V2_format {
  system_status          String   @default("")
  search_url             String?  @default("")
  scraping_brand         String?  @default("")
  scraping_industry      String?  @default("")
  scraping_caption       String?  @default("")
  scraping_landingpage   String?  @default("")
  scraping_likes         BigInt?
  scraping_comments      BigInt?
  scraping_shares        BigInt?
  scraping_ctr           BigInt?
  scraping_budget        String?  @default("")
  scraping_ctr_top       BigInt?
  scraping_ctr_sec       Json?    @db.Json
  scraping_cvr_top       BigInt?
  scraping_cvr_sec       Json?    @db.Json
  system_id              BigInt   @id @default(autoincrement())
  search_condition       String?  @default("")
  video_product_category String?  @default("")
  video_product_details  String?  @default("")
  video_target_age       String?  @default("")
  video_target_gender    String?  @default("")
  video_content_type     String?  @default("")
  video_content_summary  String?  @default("")
  video_content_music    String?  @default("")
  video_content_speed    String?  @default("")
  video_target_details   String?  @default("")
  system_usable          Boolean?
  video_url              String?  @default("")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model requestlist {
  id           BigInt   @id @default(autoincrement())
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  name         String?
  company_name String?
  email        String?
  tiktok_url   String?
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model project {
  system_userid    String
  system_createdAt DateTime @default(now()) @db.Timestamptz(6)
  userinput        Json?    @db.Json
  comment          Json?    @db.Json
  hook             Json?    @db.Json
  hook_count       Int?     @db.SmallInt
  content          Json?    @db.Json
  content_count    Int?     @db.SmallInt
  id               BigInt   @id @unique @default(autoincrement())
  User             User     @relation(fields: [system_userid], references: [userId], onDelete: NoAction, onUpdate: NoAction)
}

model Transaction {
  id              String   @id @default(cuid())
  userId          String
  amount          Int
  quantity        Int
  stripeSessionId String   @unique
  status          String
  type            String
  createdAt       DateTime @default(now()) @db.Timestamptz(6)
  updatedAt       DateTime @updatedAt @db.Timestamptz(6)
  user            User     @relation(fields: [userId], references: [userId], onDelete: Cascade)
}

model PlanningSession {
  id               String            @id @default(cuid())
  sessionToken     String?           @unique
  finishedAt       DateTime?         @db.Timestamptz(6)
  lastPage         PlanningPages?
  lastStep         Int?
  product          String?
  userId           String
  competitors      String[]
  keyword          String?
  ads              Ads[]
  creativeBrief    CreativeBrief?
  planningPlans    PlanningPlan?
  User             User              @relation(fields: [userId], references: [id])
  planningVariants PlanningVariants?
  renderedVideos   RenderedVideo[]
}

model CreativeBrief {
  id                String          @id @default(cuid())
  keyMessages       String?
  strongPoints      String[]
  planningSessionId String          @unique
  PlanningSession   PlanningSession @relation(fields: [planningSessionId], references: [id])
}

model PlanningPlan {
  id                              String          @id @default(cuid())
  currency                        String?
  estimated_cost_per_video        Int?
  recommended_min_spend_per_video Int?
  test_term_weeks                 Int?
  videos_per_month                Int?
  platform                        String?
  target_impressions_per_video    Int?
  typical_cpm                     Int?
  planningSessionId               String          @unique
  budget                          Int?
  template_id                     String?
  PlanningSession                 PlanningSession @relation(fields: [planningSessionId], references: [id])
}

model PlanningVariants {
  id                String          @id @default(cuid())
  hooks             String[]
  bodyA_messages    String[]
  bodyB_messages    String[]
  bodyC_messages    String[]
  ctas              String[]
  planningSessionId String          @unique
  PlanningSession   PlanningSession @relation(fields: [planningSessionId], references: [id])
}

model RenderedVideo {
  id                String          @id @default(cuid())
  videoUrl          String
  createdAt         DateTime        @default(now()) @db.Timestamptz(6)
  planningSessionId String
  bodyAMessage      String?
  bodyBMessage      String?
  bodyCMessage      String?
  cta               String?
  hook              String?
  PlanningSession   PlanningSession @relation(fields: [planningSessionId], references: [id])
}

model Ads {
  id                String          @id @default(cuid())
  adUrl             String
  createdAt         DateTime        @default(now()) @db.Timestamptz(6)
  performance       Json?           @db.Json
  planningSessionId String
  PlanningSession   PlanningSession @relation(fields: [planningSessionId], references: [id])
}

model GoogleAdsCredential {
  id           String    @id @default(dbgenerated("(gen_random_uuid())::text"))
  userId       String    @unique
  refreshToken String
  customerIds  String[]
  createdAt    DateTime? @default(now()) @db.Timestamptz(6)
  updatedAt    DateTime? @default(now()) @db.Timestamptz(6)
}

enum PlanningPages {
  switch
  what_scratch
  what_skip
  how
  generation
}
